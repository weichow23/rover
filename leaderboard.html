<!DOCTYPE html>
<html>
<head>
    <title>VSI-Bench Leaderboard - Thinking in Space</title>
    <link rel="icon" type="image/x-icon" href="./static/img/icons/brain.ico">

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta property="og:url" content="https://vision-x-nyu.github.io/thinking-in-space.github.io/leaderboard.html" />
    <meta property="og:image" content="./static/img/preview.png" />
    <meta property="og:title" content="VSI-Bench Leaderboard - Thinking in Space" />

    <meta name="twitter:url" content="https://vision-x-nyu.github.io/thinking-in-space.github.io/leaderboard.html" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content="./static/img/preview.png" />
    <meta name="twitter:title" content="VSI-Bench Leaderboard - Thinking in Space" />
    <meta name="twitter:description" content="Official leaderboard for VSI-Bench: A benchmark for evaluating visual-spatial intelligence of Multimodal Large Language Models." />

    <script src="./static/js/distill_template.v2.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://d3js.org/d3-collection.v1.min.js"></script>
    <script src="https://rawgit.com/nstrayer/slid3r/master/dist/slid3r.js"></script>

    <script defer="" src="./static/js/hider.js"></script>
    <script src="./static/js/image_interact.js"></script>
    <script src="./static/js/switch_videos.js"></script>
    <script src="./static/js/video-speed.js"></script>

    <link rel="stylesheet" href="./static/css/style.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" xintegrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" xintegrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" xintegrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

    <script src="./static/js/fontawesome.all.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
    <script src="./static/js/medium-zoom.min.js"></script>
    <script src="./static/js/zoom.js"></script>

    <style>
        body {
            font-family: 'Charter', 'Bitstream Charter', 'Sitka Text', Cambria, serif;
        }
        .leaderboard-container {
            margin: 0 auto;
            padding: 20px;
        }
        
        .leaderboard-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .leaderboard-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            background: #ffffff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            font-size: 14px;
            margin: 20px auto;
        }

        .leaderboard-table thead {
            background: #4a5568;
            color: white;
        }

        .leaderboard-table th {
            padding: 14px 12px;
            text-align: center;
            font-weight: 600;
            font-size: 13px;
            letter-spacing: 0.025em;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .sortable-header {
            cursor: pointer;
            user-select: none;
        }
        
        .sortable-header .sort-indicator {
            position: absolute;
            right: 8px;
            top: 50%;
            font-size: 14px;
            line-height: 1;
            transform: translateY(-50%);
            color: #a0aec0;
        }

        .sortable-header.active .sort-indicator {
            color: white;
        }
        
        .section-header {
            background-color: #deeef8;
            font-weight: 700;
            color: #2d3748;
            letter-spacing: 1px;
            font-size: 18px;
            text-align: center;
            padding: 12px !important;
            border-bottom: 2px solid #e2e8f0;
        }

        .leaderboard-table td {
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
            color: #4a5568;
            text-align: center;
        }
        
        .leaderboard-table tbody tr {
            transition: background-color 0.15s ease;
        }
        
        .leaderboard-table tbody tr:hover {
            background-color: #f7fafc;
        }

        .leaderboard-table td:first-child {
            font-weight: 600;
            text-align: left;
            color: #2d3748;
            padding-left: 20px;
        }
        
        .leaderboard-table td:nth-child(5) {
            font-weight: 700;
            font-size: 15px;
            color: #2d3748;
        }
        
        .human-level-row {
            background: #fffbeb85 !important;
            font-weight: 600;
        }
        
        .top-performer {
            background: #f0fdf494 !important;
        }

        .top-performer td:first-child::before {
            content: 'ðŸ¥‡ ';
        }

        .model-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            margin-left: 8px;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        .proprietary-badge {
            background: #e2e8f0;
            color: #475569;
            border: 1px solid #cbd5e0;
        }

        .open-badge {
            background: #e6fffa;
            color: #047857;
            border: 1px solid #a7f3d0;
        }
        
        .leaderboard-table tbody tr:nth-child(even) {
            background-color: #fafafa;
        }
        
        .baseline-row {
            font-style: italic;
            opacity: 0.8;
            background-color: #f9fafb;
        }
        
        .best-score {
            font-weight: 700;
            text-decoration: underline;
            text-decoration-color: #cbd5e0;
            text-underline-offset: 2px;
        }

        .section-divider {
            border-top: 2px solid #e2e8f0;
        }
        
        .back-button {
            display: inline-block;
            margin: 20px 0;
            padding: 12px 24px;
            background-color: #FFF0CE;
            color: #000;
            border: 2px solid rgba(255, 193, 7, 0.5);
            border-radius: 8px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .back-button:hover {
            background-color: #FFE082;
            border-color: rgba(255, 193, 7, 0.8);
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(255, 193, 7, 0.2);
        }
        
        .header-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 30px;
            padding: 20px;
        }
        
        .header-content {
            flex: 1;
            text-align: left;
        }
        
        .header-image {
            flex-shrink: 0;
            max-width: 45%;
        }
        
        .header-image img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0;
        }
        
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                text-align: center;
            }
            
            .header-content {
                text-align: center;
            }
            
            .header-image {
                max-width: 90%;
                order: -1;
            }
            
            .leaderboard-table {
                width: 100%;
                margin-left: 0;
                font-size: 12px;
            }
            
            .leaderboard-table th,
            .leaderboard-table td {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
<div class="header-wrapper">
    <div class="header-container" id="header-container">
        <div class="header-content">
            <h1 style="margin-top: 0px"><i>VSI-Bench Leaderboard</i></h1>
            
            <div class="button-container">
                <a href="index.html" class="button paper-link">
                    <span class="icon is-small">
                        <i class="fas fa-home"></i>
                    </span>
                    Back to Blog
                </a>
                <a href="https://arxiv.org/abs/2412.14171" class="button paper-link" target="_blank">
                    <span class="icon is-small">
                        <i class="ai ai-arxiv"></i>
                    </span>
                    arXiv
                </a>
                <a href="https://huggingface.co/datasets/nyu-visionx/VSI-Bench" class="button" target="_blank">
                    <span class="icon is-small">
                        <img src="https://huggingface.co/front/assets/huggingface_logo-noborder.svg" alt="Hugging Face logo" style="height: 1em;">
                    </span>
                    <span>Dataset</span>
                </a>
                <a href="https://github.com/vision-x-nyu/thinking-in-space" class="button" target="_blank">
                    <span class="icon is-small">
                        <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                </a>
            </div>
        </div>
        
        <div class="header-image">
            <img draggable="false" src="./static/img/preview.png" alt="Leaderboard Preview" class="teaser-image">
        </div>
    </div>
</div>

<div class="leaderboard-container">
    <div class="leaderboard-header">
        <h1>VSI-Bench Leaderboard</h1>
        <p>
            <strong>Note:</strong> To include your model in the leaderboard, please email <a href="mailto:jihanyang13@gmail.com">jihanyang13@gmail.com</a> with evaluation logs and setups.
        </p>
    </div>

    <table class="leaderboard-table">
        <thead>
            <tr class="header-group">
                <th rowspan="2" data-column-index="0">Model</th>
                <th rowspan="2" data-column-index="1">LLM Params</th>
                <th rowspan="2" data-column-index="2">Frames</th>
                <th rowspan="2" data-column-index="3">Date</th>
                <th rowspan="2" data-column-index="4">Avg.</th>
                <th colspan="4">Numerical Answer Questions</th>
                <th colspan="4">Multiple-Choice Questions</th>
            </tr>
            <tr>
                <th data-column-index="5">Obj. Count</th>
                <th data-column-index="6">Abs. Dist.</th>
                <th data-column-index="7">Obj. Size</th>
                <th data-column-index="8">Room Size</th>
                <th data-column-index="9">Rel. Dist.</th>
                <th data-column-index="10">Rel. Dir.</th>
                <th data-column-index="11">Route Plan</th>
                <th data-column-index="12">Appear. Order</th>
            </tr>
        </thead>
        <tbody id="leaderboard-body">
            <tr class="section-header">
                <td colspan="13">Baselines</td>
            </tr>
            <tr class="baseline-row">
                <td>Chance-level (Random)</td>
                <td>-</td>
                <td>-</td>
                <td>2024-11-15</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>25.0</td>
                <td>36.1</td>
                <td>28.3</td>
                <td>25.0</td>
            </tr>
            <tr class="baseline-row">
                <td>Chance-level (Frequency)</td>
                <td>-</td>
                <td>-</td>
                <td>2024-11-15</td>
                <td>34.0</td>
                <td>62.1</td>
                <td>32.0</td>
                <td>29.9</td>
                <td>33.1</td>
                <td>25.1</td>
                <td>47.9</td>
                <td>28.4</td>
                <td>25.2</td>
            </tr>
            <tr class="human-level-row">
                <td><strong>Human-Level</strong></td>
                <td>-</td>
                <td>-</td>
                <td>2024-11-15</td>
                <td class="best-score">79.2</td>
                <td class="best-score">94.3</td>
                <td>47.0</td>
                <td>60.4</td>
                <td>45.9</td>
                <td class="best-score">94.7</td>
                <td class="best-score">95.8</td>
                <td class="best-score">95.8</td>
                <td class="best-score">100.0</td>
            </tr>
            <tr class="section-divider">
                <td colspan="13" class="section-header">MLLMs</td>
            </tr>
            <tr>
                <td>VLM-3R (7B) <span class="model-badge open-badge">Open</span></td>
                <td>7B</td>
                <td>32</td>
                <td>2025-06-01</td>
                <td>58.8</td>
                <td>70.2</td>
                <td>49.4</td>
                <td>69.2</td>
                <td>67.1</td>
                <td>65.4</td>
                <td>80.5</td>
                <td>45.4</td>
                <td>40.1</td>
            </tr>
            <tr>
                <td>Gemini-1.5-Pro <span class="model-badge proprietary-badge">Proprietary</span></td>
                <td>-</td>
                <td>-</td>
                <td>2024-11-15</td>
                <td>48.8</td>
                <td>49.6</td>
                <td>28.8</td>
                <td>58.6</td>
                <td>49.4</td>
                <td>46.0</td>
                <td>48.1</td>
                <td>42.0</td>
                <td>68.0</td>
            </tr>
            <tr>
                <td>InternVL3-78B <span class="model-badge open-badge">Open</span></td>
                <td>78B</td>
                <td>64</td>
                <td>2025-04-19</td>
                <td>48.4</td>
                <td>71.2</td>
                <td>53.7</td>
                <td>44.4</td>
                <td>39.5</td>
                <td>55.9</td>
                <td>39.5</td>
                <td>28.9</td>
                <td>54.5</td>
            </tr>
            <tr>
                <td>GPT-4o <span class="model-badge proprietary-badge">Proprietary</span></td>
                <td>-</td>
                <td>64</td>
                <td>2025-04-03</td>
                <td>47.8</td>
                <td>43.1</td>
                <td>34.1</td>
                <td>68.6</td>
                <td>64.2</td>
                <td>48.3</td>
                <td>43.1</td>
                <td>29.4</td>
                <td>51.3</td>
            </tr>
            <tr>
                <td>Gemini-1.5 Flash <span class="model-badge proprietary-badge">Proprietary</span></td>
                <td>-</td>
                <td>-</td>
                <td>2024-11-15</td>
                <td>45.7</td>
                <td>50.8</td>
                <td>33.6</td>
                <td>56.5</td>
                <td>45.2</td>
                <td>48.0</td>
                <td>39.8</td>
                <td>32.7</td>
                <td>59.2</td>
            </tr>
            <tr>
                <td>Gemini-2.0 Flash <span class="model-badge proprietary-badge">Proprietary</span></td>
                <td>-</td>
                <td>-</td>
                <td>2024-12-20</td>
                <td>45.4</td>
                <td>52.4</td>
                <td>30.6</td>
                <td>66.7</td>
                <td>31.8</td>
                <td>56.0</td>
                <td>46.3</td>
                <td>24.5</td>
                <td>55.1</td>
            </tr>
            <tr>
                <td>LLaVA-Video-72B <span class="model-badge open-badge">Open</span></td>
                <td>72B</td>
                <td>32</td>
                <td>2024-11-24</td>
                <td>40.9</td>
                <td>48.9</td>
                <td>22.8</td>
                <td>57.4</td>
                <td>35.3</td>
                <td>42.4</td>
                <td>36.7</td>
                <td>35.0</td>
                <td>48.6</td>
            </tr>
            <tr>
                <td>LLaVA-OneVision-72B <span class="model-badge open-badge">Open</span></td>
                <td>72B</td>
                <td>32</td>
                <td>2024-11-27</td>
                <td>40.2</td>
                <td>43.5</td>
                <td>23.9</td>
                <td>57.6</td>
                <td>37.5</td>
                <td>42.5</td>
                <td>39.9</td>
                <td>32.5</td>
                <td>44.6</td>
            </tr>
            <tr>
                <td>InternVL2-8B <span class="model-badge open-badge">Open</span></td>
                <td>8B</td>
                <td>32</td>
                <td>2024-11-17</td>
                <td>37.5</td>
                <td>31.3</td>
                <td>29.0</td>
                <td>48.9</td>
                <td>44.2</td>
                <td>38.0</td>
                <td>33.4</td>
                <td>28.9</td>
                <td>46.4</td>
            </tr>
            <tr>
                <td>InternVL2-40B <span class="model-badge open-badge">Open</span></td>
                <td>40B</td>
                <td>32</td>
                <td>2024-11-18</td>
                <td>37.0</td>
                <td>41.3</td>
                <td>26.2</td>
                <td>48.2</td>
                <td>27.5</td>
                <td>47.6</td>
                <td>32.7</td>
                <td>27.8</td>
                <td>44.7</td>
            </tr>
            <tr>
                <td>LLaVA-Video-7B <span class="model-badge open-badge">Open</span></td>
                <td>7B</td>
                <td>32</td>
                <td>2024-11-23</td>
                <td>35.6</td>
                <td>48.5</td>
                <td>14.0</td>
                <td>47.8</td>
                <td>24.2</td>
                <td>43.5</td>
                <td>42.4</td>
                <td>34.0</td>
                <td>30.6</td>
            </tr>
            <tr>
                <td>GPT-4o <span class="model-badge proprietary-badge">Proprietary</span></td>
                <td>-</td>
                <td>16</td>
                <td>2024-11-15</td>
                <td>34.0</td>
                <td>46.2</td>
                <td>5.3</td>
                <td>43.8</td>
                <td>38.2</td>
                <td>37.0</td>
                <td>41.3</td>
                <td>31.5</td>
                <td>28.5</td>
            </tr>
            <tr>
                <td>LLaVA-OneVision-7B <span class="model-badge open-badge">Open</span></td>
                <td>7B</td>
                <td>32</td>
                <td>2024-11-26</td>
                <td>32.4</td>
                <td>47.7</td>
                <td>20.2</td>
                <td>47.4</td>
                <td>12.3</td>
                <td>42.5</td>
                <td>35.2</td>
                <td>29.4</td>
                <td>24.4</td>
            </tr>
            <tr>
                <td>VILA-1.5-40B <span class="model-badge open-badge">Open</span></td>
                <td>40B</td>
                <td>32</td>
                <td>2024-11-21</td>
                <td>31.2</td>
                <td>22.4</td>
                <td>24.8</td>
                <td>48.7</td>
                <td>22.7</td>
                <td>40.5</td>
                <td>25.7</td>
                <td>31.5</td>
                <td>32.9</td>
            </tr>
            <tr>
                <td>LongVA-7B <span class="model-badge open-badge">Open</span></td>
                <td>7B</td>
                <td>32</td>
                <td>2024-11-22</td>
                <td>29.2</td>
                <td>38.0</td>
                <td>16.6</td>
                <td>38.9</td>
                <td>22.2</td>
                <td>33.1</td>
                <td>43.3</td>
                <td>25.4</td>
                <td>15.7</td>
            </tr>
            <tr>
                <td>VILA-1.5-8B <span class="model-badge open-badge">Open</span></td>
                <td>8B</td>
                <td>32</td>
                <td>2024-11-20</td>
                <td>28.9</td>
                <td>17.4</td>
                <td>21.8</td>
                <td>50.3</td>
                <td>18.8</td>
                <td>32.1</td>
                <td>34.8</td>
                <td>31.0</td>
                <td>24.8</td>
            </tr>
            <tr>
                <td>LLaVA-OneVision-0.5B <span class="model-badge open-badge">Open</span></td>
                <td>0.5B</td>
                <td>32</td>
                <td>2024-11-25</td>
                <td>28.0</td>
                <td>46.1</td>
                <td>28.4</td>
                <td>15.4</td>
                <td>28.3</td>
                <td>28.9</td>
                <td>36.9</td>
                <td>34.5</td>
                <td>5.8</td>
            </tr>
            <tr>
                <td>InternVL2-8B <span class="model-badge open-badge">Open</span></td>
                <td>8B</td>
                <td>32</td>
                <td>2024-11-16</td>
                <td>26.5</td>
                <td>25.7</td>
                <td>24.0</td>
                <td>20.0</td>
                <td>29.2</td>
                <td>32.1</td>
                <td>44.1</td>
                <td>30.4</td>
                <td>6.3</td>
            </tr>
            <tr>
                <td>SmoVLM2-2.2B <span class="model-badge open-badge">Open</span></td>
                <td>2.2B</td>
                <td>32</td>
                <td>2025-06-26</td>
                <td>26.5</td>
                <td>25.7</td>
                <td>27.1</td>
                <td>30.9</td>
                <td>14.2</td>
                <td>33.2</td>
                <td>42.3</td>
                <td>33.0</td>
                <td>5.3</td>
            </tr>
            <tr>
                <td>SmoVLM2-500M <span class="model-badge open-badge">Open</span></td>
                <td>500M</td>
                <td>32</td>
                <td>2025-06-26</td>
                <td>25.8</td>
                <td>8.0</td>
                <td>29.7</td>
                <td>30.4</td>
                <td>27.5</td>
                <td>28.2</td>
                <td>33.9</td>
                <td>26.8</td>
                <td>21.7</td>
            </tr>
            <tr>
                <td>LongVILA-8B <span class="model-badge open-badge">Open</span></td>
                <td>8B</td>
                <td>32</td>
                <td>2024-11-19</td>
                <td>21.6</td>
                <td>29.1</td>
                <td>9.1</td>
                <td>16.7</td>
                <td>0.0</td>
                <td>29.6</td>
                <td>30.7</td>
                <td>32.5</td>
                <td>25.5</td>
            </tr>
            <tr>
                <td>SmoVLM2-256M <span class="model-badge open-badge">Open</span></td>
                <td>256M</td>
                <td>32</td>
                <td>2025-06-26</td>
                <td>21.4</td>
                <td>50.5</td>
                <td>1.8</td>
                <td>1.3</td>
                <td>0.0</td>
                <td>30.3</td>
                <td>36.4</td>
                <td>25.8</td>
                <td>25.1</td>
            </tr>
        </tbody>
    </table>

    <div style="margin-top: 40px; text-align: center;">
        <a href="index.html" class="back-button">
            <i class="fas fa-arrow-left"></i> Back to Paper
        </a>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const table = document.querySelector('.leaderboard-table');
        const thead = table.querySelector('thead');
        const tbody = document.getElementById('leaderboard-body');
        // Default sort configuration: by 'Avg.' column (index 4), descending.
        let sortConfig = {
            columnIndex: 4, 
            direction: 'desc'
        };

        const headers = thead.querySelectorAll('th[data-column-index]');

        // Updates the visual indicators (â–²/â–¼) on the table headers.
        function updateSortIndicators() {
            headers.forEach(h => {
                const indicator = h.querySelector('.sort-indicator');
                if (indicator) {
                    const hIndex = parseInt(h.dataset.columnIndex);
                    if (hIndex === sortConfig.columnIndex) {
                        indicator.textContent = sortConfig.direction === 'asc' ? 'â–²' : 'â–¼';
                        h.classList.add('active');
                    } else {
                        indicator.textContent = '';
                        h.classList.remove('active');
                    }
                }
            });
        }
        
        // Parses the 'LLM Params' column, converting values like '7B' or '500M' to numbers.
        function parseParams(param) {
            if (param === '-') return -1;
            const value = parseFloat(param);
            if (isNaN(value)) return -1;
            if (param.toLowerCase().includes('b')) return value * 1e9;
            if (param.toLowerCase().includes('m')) return value * 1e6;
            return value;
        }

        // Generic comparison function for sorting. Handles strings, dates, params, and numbers.
        function compareValues(valA, valB, index) {
            // Column 0: Model name (string comparison)
            if (index === 0) { 
                return valA.localeCompare(valB);
            }
            // Column 1: LLM Params (special parsing)
            if (index === 1) { 
                return parseParams(valA) - parseParams(valB);
            }
            // Column 3: Date (date comparison)
            if (index === 3) { 
                return new Date(valA) - new Date(valB);
            }

            // Default: Numeric comparison for all other columns
            const numA = parseFloat(valA);
            const numB = parseFloat(valB);

            const isNumA = !isNaN(numA);
            const isNumB = !isNaN(numB);

            if (isNumA && isNumB) return numA - numB;
            if (isNumA) return 1; // Put non-numeric values ('-') at the bottom
            if (isNumB) return -1;
            return 0;
        }

        // Main function to sort the table body.
        function sortTable() {
            const rows = Array.from(tbody.querySelectorAll('tr'));
            
            // Filter out rows that should not be sorted (e.g., section headers, baselines).
            const sortableRows = rows.filter(row => 
                !row.classList.contains('baseline-row') &&
                !row.classList.contains('human-level-row') &&
                !row.classList.contains('section-divider') &&
                !row.classList.contains('section-header') // This was the corrected part
            );
            
            const direction = sortConfig.direction === 'asc' ? 1 : -1;

            // Sort the filtered rows based on the selected column and direction.
            sortableRows.sort((rowA, rowB) => {
                const cellA = rowA.children[sortConfig.columnIndex].textContent.trim();
                const cellB = rowB.children[sortConfig.columnIndex].textContent.trim();
                return compareValues(cellA, cellB, sortConfig.columnIndex) * direction;
            });

            // Append the sorted rows back to the table body.
            // This moves them to the end, after the non-sortable rows which were not removed.
            sortableRows.forEach(row => tbody.appendChild(row));
            updateSortIndicators();
        }

        // Add click listeners to all sortable headers.
        headers.forEach(header => {
            header.classList.add('sortable-header');
            const indicator = document.createElement('span');
            indicator.className = 'sort-indicator';
            header.appendChild(indicator);

            header.addEventListener('click', () => {
                const columnIndex = parseInt(header.dataset.columnIndex);
                // If clicking the same column, reverse direction.
                if (sortConfig.columnIndex === columnIndex) {
                    sortConfig.direction = sortConfig.direction === 'asc' ? 'desc' : 'asc';
                } else {
                    // Otherwise, switch to the new column and default to descending.
                    sortConfig.columnIndex = columnIndex;
                    sortConfig.direction = 'desc';
                }
                sortTable();
            });
        });

        // Perform the initial sort when the page loads.
        sortTable();
    });
</script>
</body>
</html>
